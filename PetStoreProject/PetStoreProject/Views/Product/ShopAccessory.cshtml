@{
    ViewData["Title"] = "Phụ kiện";
}

@using PetStoreProject.ViewModels;
@using PetStoreProject.Helper;
@model PaginatedList<ProductDetailViewModel>;
@using PetStoreProject.Models;

@{
    var selectPageSize = ViewBag.pageSize;
}
<style>
    .sidebar-brand-list {
        max-height: 300px;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: #888 #f1f1f1;
    }

        .sidebar-brand-list::-webkit-scrollbar {
            width: 5px; /* Độ rộng của thanh cuộn */
        }

        /* Màu nền của thanh cuộn trên Chrome và Safari */
        .sidebar-brand-list::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        /* Màu của thanh cuộn trên Chrome và Safari */
        .sidebar-brand-list::-webkit-scrollbar-thumb {
            background: #888;
        }

    .price-input {
        width: 100%;
        display: flex;
        margin: 30px 0 35px;
    }

        .price-input .field {
            display: flex;
            width: 100%;
            height: 45px;
            align-items: center;
        }

    .field input {
        width: 100%;
        height: 100%;
        outline: none;
        font-size: 16px;
        margin-right: 5px;
        border-radius: 5px;
        text-align: center;
        border: 1px solid #999;
        -moz-appearance: textfield;
    }

    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
        -webkit-appearance: none;
    }

    .price-input .separator {
        width: 130px;
        display: flex;
        font-size: 19px;
        align-items: center;
        justify-content: center;
    }

    .slider {
        height: 5px;
        position: relative;
        background: #ddd;
        border-radius: 5px;
    }

        .slider .progress {
            height: 100%;
            left: 0%;
            right: 0%;
            position: absolute;
            border-radius: 5px;
            background: #17A2B8;
        }

    .range-input {
        position: relative;
    }

        .range-input input {
            position: absolute;
            width: 100%;
            height: 5px;
            top: -5px;
            background: none;
            pointer-events: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

    input[type="range"]::-webkit-slider-thumb {
        height: 17px;
        width: 17px;
        border-radius: 50%;
        background: #17A2B8;
        pointer-events: auto;
        -webkit-appearance: none;
        box-shadow: 0 0 6px rgba(0,0,0,0.05);
    }

    input[type="range"]::-moz-range-thumb {
        height: 17px;
        width: 17px;
        border: none;
        border-radius: 50%;
        background: #17A2B8;
        pointer-events: auto;
        -moz-appearance: none;
        box-shadow: 0 0 6px rgba(0,0,0,0.05);

    }
    /* CSS cho nút Lọc sản phẩm và Xóa bộ lọc */
    .single_sidebar {
        margin-bottom: 20px;
    }

    .btn {
        display: inline-block;
        padding: 8px 16px;
        font-size: 14px;
        cursor: pointer;
        border: 1px solid #ccc;
        border-radius: 4px;
        background-color: #f8f9fa;
        color: #333;
        text-decoration: none;
        transition: all 0.3s ease;
    }

        .btn:hover {
            background-color: #e9ecef;
        }

    .btn-light {
        background-color: #f8f9fa;
        color: #333;
    }

        .btn-light:hover {
            background-color: #e9ecef;
        }

</style>

<div class="main-shop-page adp_top adp_bottom">
    <div class="container">
        <!-- Row End -->
        <div class="row">
            <!-- Sidebar Shopping Option Start -->
            <div class="col-lg-3 order-2 order-lg-1">
                <div class="sidebar shop-sidebar">
                    <!-- Sidebar Categorie Start -->
                    <div class="sidebar-categorie single_sidebar">
                        <h3 class="sidebar-title">Thương hiệu</h3>
                        <div class="sidebar-brand-list">
                            <ul class="sidbar-style">
                                @foreach (var brand in ViewBag.Brands as List<Brand>)
                                {
                                    <li class="form-check">
                                        <input class="form-check-input brand-checkbox" value="@brand.Name" id="@($"camera_{brand.BrandId}")" type="checkbox">
                                        <label class="form-check-label" for="@($"camera_{brand.BrandId}")">@brand.Name</label>
                                    </li>
                                }
                            </ul>
                        </div>
                    </div>
                    <!-- Sidebar Categorie Start -->
                    <!-- Price Filter Options Start -->
                    <div class="search-filter single_sidebar">
                        <h3 class="sidebar-title">Giá</h3>
                        <div class="price-input">
                            <div class="field">
                                <input type="number" readonly class="input-min" value="@ViewBag.priceMin">
                                <span>đ</span>
                            </div>
                            <div class="separator">-</div>
                            <div class="field">
                                <input type="number" readonly class="input-max" value="@ViewBag.priceMax">
                                <span>đ</span>
                            </div>
                        </div>
                        <div class="slider">
                            <div class="progress"></div>
                        </div>
                        <div class="range-input">
                            <input type="range" class="range-min" min="@ViewBag.priceMin" max="@ViewBag.priceMax" value="@ViewBag.priceMin" step="1000">
                            <input type="range" class="range-max" min="@ViewBag.priceMin" max="@ViewBag.priceMax" value="@ViewBag.priceMax" step="1000">
                        </div>
                    </div>
                    <!-- Price Filter Options End -->
                    <!-- Product Size Start -->
                    <div class="size single_sidebar">
                        <h3 class="sidebar-title">Kích cỡ</h3>
                        <ul class="size-list sidbar-style">
                            <li class="form-check">
                                <input class="form-check-input size-checkboxes" value="S" id="small" type="checkbox">
                                <label class="form-check-label" for="small">S</label>
                            </li>
                            <li class="form-check">
                                <input class="form-check-input size-checkboxes" value="M" id="medium" type="checkbox">
                                <label class="form-check-label" for="medium">M</label>
                            </li>
                            <li class="form-check">
                                <input class="form-check-input size-checkboxes" value="L" id="large" type="checkbox">
                                <label class="form-check-label" for="large">L</label>
                            </li>
                            <li class="form-check">
                                <input class="form-check-input size-checkboxes" value="XL" id="xtra-large" type="checkbox">
                                <label class="form-check-label" for="xtra-large">XL</label>
                            </li>
                            <li class="form-check">
                                <input class="form-check-input size-checkboxes" value="XXL" id="dobule-extra-large" type="checkbox">
                                <label class="form-check-label" for="dobule-extra-large">XXL</label>
                            </li>
                        </ul>
                    </div>
                    <!-- Product Size End -->
                    <!-- Product Color Start -->
                    <div class="color single_sidebar">
                        <h3 class="sidebar-title">Màu sắc</h3>
                        <ul class="color-option sidbar-style">
                            <li>
                                <input class="form-check-input color-checkboxes" value="Đen" id="color_black" type="checkbox">
                                <label class="form-check-label" for="color_black"> Đen </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Cam" id="color_orange" type="checkbox">
                                <label class="form-check-label" for="color_orange"> Cam </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Nâu" id="color_blue" type="checkbox">
                                <label class="form-check-label" for="color_blue"> Nâu </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Vàng" id="color_yellow" type="checkbox">
                                <label class="form-check-label" for="color_yellow"> Vàng </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Xanh" id="color_green" type="checkbox">
                                <label class="form-check-label" for="color_green"> Xanh </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Hồng" id="color_prink" type="checkbox">
                                <label class="form-check-label" for="color_prink"> Hồng </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Trắng" id="color_white" type="checkbox">
                                <label class="form-check-label" for="color_white"> Trắng </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Tím" id="color_pupple" type="checkbox">
                                <label class="form-check-label" for="color_pupple"> Tím </label>
                            </li>
                            <li>
                                <input class="form-check-input color-checkboxes" value="Xám" id="color_gray" type="checkbox">
                                <label class="form-check-label" for="color_gray"> Xám </label>
                            </li>
                            
                        </ul>
                    </div>
                    <div class="single_sidebar">
                        <button class="btn btn-light" id="filter_button">Lọc sản phẩm</button>
                        <button class="btn btn-light" id="clear_button">Xóa bộ lọc</button>
                    </div>
                    <!-- Product Color End -->
                    <!-- Popular Product Start -->
                    <div class="polular_products single_sidebar">
                        <div class="product-widget-chunk-wrapper">
                            <h3 class="sidebar-title">Sản phẩm phổ biến</h3>

                            <!--=======  widget product list wrapper  =======-->
                            <div class="small-list-wrapper">

                                <!--=======  single widget product  =======-->
                                <div class="small-list-product">
                                    <div class="small-list-inner">
                                        <div class="small-list-img">
                                            <a href="single-product.html">
                                                <img src="img/products/p1.jpg" class="img-fluid" alt="">
                                            </a>
                                        </div>
                                        <div class="small-list-content">
                                            <h3 class="small-list-title"> <a href="single-product.html">Small Product Title Here</a></h3>
                                            <p class="small-list-price">
                                                <span class="regular-price">$150.00</span>
                                                <span class="dis-price">$250.00</span>
                                            </p>

                                            <div class="product-rating">
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--=======  End of single widget product  =======-->
                                <!--=======  single widget product  =======-->
                                <div class="small-list-product">
                                    <div class="small-list-inner">
                                        <div class="small-list-img">
                                            <a href="single-product.html">
                                                <img src="img/products/p2.jpg" class="img-fluid" alt="">
                                            </a>
                                        </div>
                                        <div class="small-list-content">
                                            <h3 class="small-list-title"> <a href="single-product.html">Small Product Title Here</a></h3>
                                            <p class="small-list-price">
                                                <span class="regular-price">$150.00</span>
                                                <span class="dis-price">$200.00</span>
                                            </p>

                                            <div class="product-rating">
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!--=======  End of single widget product  =======-->
                                <!--=======  single widget product  =======-->
                                <div class="small-list-product">
                                    <div class="small-list-inner">
                                        <div class="small-list-img">
                                            <a href="single-product.html">
                                                <img src="img/products/p3.jpg" class="img-fluid" alt="">
                                            </a>
                                        </div>
                                        <div class="small-list-content">
                                            <h3 class="small-list-title"> <a href="single-product.html">Small Product Title Here</a></h3>
                                            <p class="small-list-price">
                                                <span class="regular-price">$170.00</span>
                                            </p>

                                            <div class="product-rating">
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!--=======  End of single widget product  =======-->
                                <!--=======  single widget product  =======-->
                                <div class="small-list-product">
                                    <div class="small-list-inner">
                                        <div class="small-list-img">
                                            <a href="single-product.html">
                                                <img src="img/products/p4.jpg" class="img-fluid" alt="">
                                            </a>
                                        </div>
                                        <div class="small-list-content">
                                            <h3 class="small-list-title"> <a href="single-product.html">Small Product Title Here</a></h3>
                                            <p class="small-list-price">
                                                <span class="regular-price">$100.00</span>
                                                <span class="dis-price">$200.00</span>
                                            </p>

                                            <div class="product-rating">
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!--=======  End of single widget product  =======-->
                                <!--=======  single widget product  =======-->
                                <div class="small-list-product">
                                    <div class="small-list-inner">
                                        <div class="small-list-img">
                                            <a href="single-product.html">
                                                <img src="img/products/p5.jpg" class="img-fluid" alt="">
                                            </a>
                                        </div>
                                        <div class="small-list-content">
                                            <h3 class="small-list-title"> <a href="single-product.html">Small Product Title Here</a></h3>
                                            <p class="small-list-price">
                                                <span class="regular-price">$190.00</span>
                                                <span class="dis-price">$250.00</span>
                                            </p>

                                            <div class="product-rating">
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!--=======  End of single widget product  =======-->
                                <!--=======  single widget product  =======-->
                                <div class="small-list-product">
                                    <div class="small-list-inner">
                                        <div class="small-list-img">
                                            <a href="single-product.html">
                                                <img src="img/products/p6.jpg" class="img-fluid" alt="">
                                            </a>
                                        </div>
                                        <div class="small-list-content">
                                            <h3 class="small-list-title"> <a href="single-product.html">Small Product Title Here</a></h3>
                                            <p class="small-list-price">
                                                <span class="regular-price">$150.00</span>
                                                <span class="dis-price">$250.00</span>
                                            </p>

                                            <div class="product-rating">
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rating"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                                <i class="icofont-ui-rate-blank"></i>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!--=======  End of single widget product  =======-->
                                <!--=======  End of widget product list wrapper  =======-->
                            </div>
                            <!--=======  End of product widget chunk wrapper  =======-->
                        </div>
                    </div>
                    <!-- Popular Product End -->
                    <!-- sidebar bannaer start -->
                    <div class="single-banner single_sidebar">
                        <a href="#">
                            <img src="~/img/banner/banner_6.png" alt="Banner Image">
                        </a>
                    </div>
                    <!-- sidebar bannaer end -->

                </div>
            </div>
            <!-- Sidebar Shopping Option End -->
            <!-- Product Categorie List Start -->
            <div class="col-lg-9 order-1 order-lg-2">
                <!-- Grid & List View Start -->
                <div class="grid-list-top">
                    <div class="grid-list-view d-flex align-items-center  mb-sm-15">
                        <ul class="nav tabs-area d-flex align-items-center">
                            <li>
                                <a class="active" data-bs-toggle="tab" href="#grid-view">
                                    <i class="icofont-ghost"></i>
                                </a>
                            </li>
                            <li>
                                <a data-bs-toggle="tab" href="#list-view">
                                    <i class="icofont-listine-dots"></i>
                                </a>
                            </li>
                        </ul>

                    </div>


                    <div class="single-select-block">
                        <select name="pageSize" id="pageSizeSelect" onchange="ChangePageSize()">
                            <!option @(selectPageSize == 20 ? "selected" : "") >20</!option>
                            <!option @(selectPageSize == 30 ? "selected" : "") >30</!option>
                            <!option @(selectPageSize == 40 ? "selected" : "") >40</!option>

                        </select>
                    </div>

                    <!-- Toolbar Short Area Start -->
                    <div class="main-toolbar-sorter clearfix">
                        <div class="toolbar-sorter d-md-flex align-items-center">
                            @* <label style="width:80px">Sắp xếp:</label> *@
                            <select id="selected_sort" onchange="SelectedSort()" class="sorter wide">
                                <option selected value="">-- Sắp xếp --</option>
                                <option value="ProductNameAZ">Tên, A tới Z</option>
                                <option value="ProductNameZA">Tên, Z tới A</option>
                                <option value="PriceLowToHight">Giá thấp đến cao</option>
                                <option value="PriceHightToLow">Giá cao đến thấp</option>
                            </select>
                        </div>
                    </div>
                    <!-- Toolbar Short Area End -->
                </div>
                <!-- Grid & List View End -->
                <div class="shop-area mb-all-40">
                    <!-- Grid & List Main Area End -->
                    <div class="tab-content">
                        <div id="grid-view" class="tab-pane fade show active class_grid_view">
                            <div id="data-grid-view" class="row border-hover-effect ">
                                @if (Model.Count > 0)
                                {
                                    @foreach (var product in Model)
                                    {
                                        <!-- Single Product Start -->
                                        <div class="col-xl-4 col-lg-6 col-md-6">
                                            <div class="single-template-product">
                                                <!-- Product Image Start -->
                                                <div class="pro-img">

                                                    <span class="sticker-sale">-25%</span>
                                                    <span class="sticker-new">Mới</span>
                                                    <a href="/product/detail/@product.ProductId">
                                                        @if (product.productOption != null && product.productOption.Count > 0)
                                                        {
                                                            <img style="max-height: 300px" class="primary-img" src="@product.productOption[0].img_url" alt="single-product">
                                                        }
                                                    </a>

                                                    @* <div class="item_quick_link">
                                            <a href="/product/detail/@product.ProductId" data-bs-toggle="modal" data-bs-target="#myModal" title="Xem chi tiết"><i class="icofont-search"></i></a>
                                            </div> *@

                                                    <div class="product-count-wrap">
                                                        <div class="product-countdown" data-countdown="2022/06/01"></div>
                                                    </div>

                                                </div>
                                                <!-- Product Image End -->
                                                <!-- Product Content Start -->
                                                <div class="product_content_wrap">
                                                    <div class="product_content">
                                                        <h4 style="height:50px; padding:5px;"><a href="/product/detail/@product.ProductId">@product.Name</a></h4>

                                                        <div class="grid_price">
                                                            @if (product.productOption != null && product.productOption.Count > 0)
                                                            {
                                                                <span class="regular-price">@product.productOption[0].price VND</span>
                                                                @* <del class="discount_price">$75.50</del> *@
                                                            }
                                                        </div>

                                                    </div>
                                                    <div class="item_add_cart">
                                                        <a class="grid_compare" href="compare.html" title="Compare"><i class="icofont-random"></i></a>
                                                        @* <a class="grid_cart cart_disable" href="#" title="Sold Out">Sold Out</a> *@
                                                        <a class="grid_cart" href="cart.html" title="Add to Cart">Add To Cart</a>
                                                        <a class="grid_wishlist" href="wishlist.html" title="Wishlist"><i class="icofont-heart-alt"></i></a>
                                                    </div>
                                                </div>
                                                <!-- Product Content End -->
                                            </div>
                                        </div>
                                        <!-- Single Product End -->
                                    }
                                }
                                else
                                {
                                    <h2>Danh sách sản phẩm trống!</h2>
                                }
                            </div>
                            @{
                                var prevDisabled = !Model.hasPreviousPage ? "disabled" : "";
                                var nextDisabled = !Model.hasNextPage ? "disabled" : "";
                            }
                            <!-- Row End -->
                        </div>
                        <!-- #grid view End -->
                        <div id="list-view" class="tab-pane fade fix class_list_view">
                            @if (Model.Count > 0)
                            {
                                @foreach (var product in Model)
                                {
                                    <div class="single-template-product">
                                        <!-- Product Image Start -->
                                        <div class="pro-img">

                                            <span class="sticker-sale">-25%</span>
                                            <span class="sticker-new">Mới</span>

                                            <a href="/product/detail/@product.ProductId">
                                                @if (product.productOption != null && product.productOption.Count > 0)
                                                {
                                                    <img class="primary-img" src="@product.productOption[0].img_url" alt="single-product">
                                                }
                                            </a>
                                            <div class="item_quick_link">
                                                <a href="#" data-bs-toggle="modal" data-bs-target="#myModal" title="Quick View"><i class="icofont-search"></i></a>
                                            </div>

                                            <div class="product-count-wrap">
                                                <div class="product-countdown" data-countdown="2022/06/01"></div>
                                            </div>
                                        </div>
                                        <!-- Product Image End -->
                                        <!-- Product Content Start -->
                                        <div class="product_content_wrap">
                                            <div class="product_content">
                                                <h4><a href="product-details.html">@product.Name</a></h4>

                                                <p class="list_des">@product.Description</p>

                                                <div class="grid_price">
                                                    @if (product.productOption != null && product.productOption.Count > 0)
                                                    {
                                                        <span class="regular-price">@product.productOption[0].price VND</span>
                                                    }
                                                </div>

                                            </div>
                                            <div class="item_add_cart">
                                                <a class="grid_compare" href="compare.html" title="Compare"><i class="icofont-random"></i></a>
                                                <a class="grid_cart" href="cart.html" title="Add to Cart">Add To Cart</a>
                                                <a class="grid_wishlist" href="wishlist.html" title="Wishlist"><i class="icofont-heart-alt"></i></a>
                                            </div>
                                        </div>
                                        <!-- Product Content End -->
                                    </div>
                                }
                            }
                            else
                            {
                                <h2>Danh sách sản phẩm trống!</h2>
                            }

                        </div>
                        <!-- #list view End -->
                    </div>
                    <!-- Grid & List Main Area End -->
                </div>
                <!-- Shop Breadcrumb Area Start -->
                <div class="shop-pagination-area border-default">
                    <div class="row">
                        <div class="col-lg-4 col-md-4 col-12 pagi_left">
                        </div>
                        <div id="pagination" class="col-lg-8 col-md-8 col-12 pagi_right">
                            <nav aria-label="Page navigation example">
                                <ul class="pagination">
                                    @if ((int)@ViewBag.numberPage > 1)
                                    {
                                        @if ((int)ViewBag.currentPage > 1)
                                        {
                                            <li class="page-item"><a class="page-link" onclick="NextPage(@(ViewBag.currentPage - 1), @(ViewBag.pageSize))" href="javascript:void(0);">Trang trước</a></li>
                                        }

                                        var startPage = Math.Max(1, (int)ViewBag.currentPage - 2);
                                        var endPage = Math.Min((int)ViewBag.numberPage, (int)ViewBag.currentPage + 2);

                                        @if (startPage > 1)
                                        {
                                            <li class="page-item"><a class="page-link" onclick="NextPage(1, @(ViewBag.pageSize))" href="javascript:void(0);">1</a></li>
                                            if (startPage > 2)
                                            {
                                                <li class="page-item"><a class="page-link" href="javascript:void(0);">...</a></li>
                                            }
                                        }
                                        @for (var i = startPage; i <= endPage; i++)
                                        {
                                            @if ((int)ViewBag.currentPage == i)
                                            {
                                                <li class="page-item active"><a class="page-link" href="javascript:void(0);">@i</a></li>
                                            }
                                            else
                                            {
                                                <li class="page-item"><a class="page-link" onclick="NextPage(@i, @(ViewBag.pageSize))" href="javascript:void(0);">@i</a></li>
                                            }
                                        }
                                        @if ((int)ViewBag.numberPage >= endPage + 1)
                                        {
                                            @if ((int)ViewBag.numberPage >= endPage + 2)
                                            {

                                                <li class="page-item"><a class="page-link" href="javascript:void(0);">...</a></li>
                                            }

                                            <li class="page-item"><a class="page-link" onclick="NextPage(@(ViewBag.numberPage), @(ViewBag.pageSize))" href="javascript:void(0);">@(ViewBag.numberPage)</a></li>
                                        }
                                        @if ((int)ViewBag.currentPage != (int)ViewBag.numberPage)
                                        {

                                            <li class="page-item"><a class="page-link" onclick="NextPage(@(ViewBag.currentPage + 1), @(ViewBag.pageSize))" href="javascript:void(0);">Trang sau</a></li>
                                        }
                                    }
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                <!-- Shop Breadcrumb Area End -->
            </div>
            <!-- product Categorie List End -->
        </div>
        <!-- Row End -->
    </div>
    <!-- Container End -->
</div>
<!-- Shop Page End -->

<script>
    var selectedBrands = [];
    var selectedColors = [];
    var selectedSizes = [];
    var pageSize = 20;
    var pageIndex = 1;
    var selectedSort = "";
    var rangeInput = document.querySelectorAll(".range-input input"),
        priceInput = document.querySelectorAll(".price-input input"),
        range = document.querySelector(".slider .progress");
    var priceGap = 1000;

    const priceMinInit = priceInput[0].value;
    const priceMaxInit = priceInput[1].value;

    rangeInput.forEach(input => {
        input.addEventListener("input", e => {
            let minVal = parseInt(rangeInput[0].value),
                maxVal = parseInt(rangeInput[1].value);

            if ((maxVal - minVal) < priceGap) {
                if (e.target.className === "range-min") {
                    rangeInput[0].value = maxVal - priceGap
                } else {
                    rangeInput[1].value = minVal + priceGap;
                }
            } else {
                priceInput[0].value = minVal;
                priceInput[1].value = maxVal;
                range.style.left = ((minVal / rangeInput[0].max) * 100) + "%";
                range.style.right = 100 - (maxVal / rangeInput[1].max) * 100 + "%";
            }
        });
    });

    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById("filter_button").addEventListener('click', function () {

            //---brands
            var checkboxesBrands = document.querySelectorAll(".brand-checkbox");
            checkboxesBrands.forEach(function (checkbox) {
                if (checkbox.checked) {
                    selectedBrands.push(checkbox.value);
                }
            });
            console.log("filter: " + selectedBrands);

            //----price
            console.log("min: " + priceInput[0].value);
            console.log("max: " + priceInput[1].value);
            console.log("pmin: " + priceMinInit);
            console.log("pmax: " + priceMaxInit);

            //---size
            var checkboxesSize = document.querySelectorAll(".size-checkboxes");
            checkboxesSize.forEach(function (checkbox) {
                if (checkbox.checked) {
                    selectedSizes.push(checkbox.value);
                }
            });
            console.log("Size: " + selectedSizes);

            //---color
            var checkboxesColor = document.querySelectorAll(".color-checkboxes");
            checkboxesColor.forEach(function (checkbox) {
                if (checkbox.checked) {
                    selectedColors.push(checkbox.value);
                }
            });
            console.log("Color: " + selectedColors);


            LoadData(pageSize, 1, selectedBrands, "", priceInput[0].value, priceInput[1].value, selectedColors, selectedSizes);
        });

        document.querySelector("#clear_button").addEventListener('click', function () {
            var checkboxes = document.querySelectorAll(".brand-checkbox");
            checkboxes.forEach(function (checkbox) {
                checkbox.checked = false;
            });
            var checkboxes = document.querySelectorAll(".size-checkboxes");
            checkboxes.forEach(function (checkbox) {
                checkbox.checked = false;
            }); 
            var checkboxes = document.querySelectorAll(".color-checkboxes");
            checkboxes.forEach(function (checkbox) {
                checkbox.checked = false;
            });
            selectedBrands = [];
            priceInput[0].value = priceMinInit;
            priceInput[1].value = priceMaxInit;
            range.style.left = "0%";
            range.style.right = "0%";
            selectedColors = [];
            selectedSizes = [];

            console.log("Filters cleared");
            LoadData(pageSize, 1, [], "", priceMinInit, priceMaxInit, [], []);
        });

    });

    function SelectedSort() {
        selectedSort = document.getElementById("selected_sort").value;
        console.log("selected_sort: change" + selectedSort);
        LoadData(pageSize, pageIndex, selectedBrands, selectedSort, priceInput[0].value, priceInput[1].value, selectedColors, selectedSizes);
    }

    function LoadData(pageSize, page, selectedBrands, selectedSort, priceInputMin, priceInputMax, selectedColors, selectedSizes) {
        $('#data-grid-view').empty();
        $('#list-view').empty();
        $.ajax({
            url: '/Product/ShopAccessory',
            type: 'post',
            data: {
                pageSize: pageSize, page: page, selectedBrands: selectedBrands, selectedSort: selectedSort,
                priceMin: priceInputMin, priceMax: priceInputMax, selectedColors: selectedColors, selectedSizes: selectedSizes
            },
            success: function (response) {
                if (response.data.length > 0) {
                    var html1 = "";
                    var html = "";
                    var items = response.data;
                    for (var index = 0; index < items.length; index++) {
                        html += "<!-- Single Product Start -->";
                        html += "<div class='col-xl-4 col-lg-6 col-md-6'>";
                        html += "<div class='single-template-product sold_out_grid'>";
                        html += "<!-- Product Image Start -->";
                        html += "<div class='pro-img'>";
                        html += "<span class='sticker-sale'>-25%</span>";
                        html += "<span class='sticker-new'>Mới</span>";
                        html += "<a href='product-details.html'>";

                        if (items[index].productOption && items[index].productOption.length > 0) {
                            html += "<img style='max-height: 300px' class='primary-img' src='" + items[index].productOption[0].img_url + "' alt='single-product'>";
                        }

                        html += "</a>";
                        html += "<div class='item_quick_link'>";
                        html += "<a href='#' data-bs-toggle='modal' data-bs-target='#myModal' title='Quick View'><i class='icofont-search'></i></a>";
                        html += "</div>";
                        html += "<div class='product-count-wrap'>";
                        html += "<div class='product-countdown' data-countdown='2022/06/01'></div>";
                        html += "</div>";
                        html += "</div>";
                        html += "<!-- Product Image End -->";
                        html += "<!-- Product Content Start -->";
                        html += "<div class='product_content_wrap'>";
                        html += "<div class='product_content'>";
                        html += "<h4 style='height: 50px; padding: 5px;'><a href='product-details.html'>" + items[index].name + "</a></h4>";
                        html += "<div class='grid_price'>";

                        if (items[index].productOption && items[index].productOption.length > 0) {
                            html += "<span class='regular-price'>" + items[index].productOption[0].price + " VND</span>";
                        }

                        html += "</div>";
                        html += "</div>";
                        html += "<div class='item_add_cart'>";
                        html += "<a class='grid_compare' href='compare.html' title='Compare'><i class='icofont-random'></i></a>";
                        html += "<a class='grid_wishlist' href='wishlist.html' title='Wishlist'><i class='icofont-heart-alt'></i></a>";
                        html += "</div>";
                        html += "</div>";
                        html += "<!-- Product Content End -->";
                        html += "</div>";
                        html += "</div>";
                        html += "<!-- Single Product End -->";

                        html1 += "<div class='single-template-product'>";
                        html1 += "<!-- Product Image Start -->";
                        html1 += "<div class='pro-img'>";
                        html1 += "<span class='sticker-sale'>-25%</span>";
                        html1 += "<span class='sticker-new'>Mới</span>";
                        html1 += "<a href='/product/detail/" + items[index].productId + "'>";
                        if (items[index].productOption && items[index].productOption.length > 0) {
                            html1 += "<img class='primary-img' src=" + items[index].productOption[0].img_url + "alt='single-product'>";
                        }
                        html1 += "</a>";
                        html1 += "<div class='item_quick_link'>";
                        html1 += "<a href='#' data-bs-toggle='modal' data-bs-target='#myModal' title='Quick View'><i class='icofont-search'></i></a>";
                        html1 += "</div>";
                        html1 += "<div class='product - count - wrap'>";
                        html1 += "<div class='product - countdown' data-countdown='2022 / 06 / 01'></div>";
                        html1 += "</div>";
                        html1 += "</div>";
                        html1 += "<!-- Product Image End -->";
                        html1 += "<!-- Product Content Start -->";
                        html1 += "<div class='product_content_wrap'>";
                        html1 += "<div class='product_content'>";
                        html1 += "<h4><a href='product - details.html1'>" + items[index].name + "</a></h4>";
                        html1 += "<p class='list_des'>" + items[index].description + "</p>";
                        html1 += "<div class='grid_price'>";
                        if (items[index].productOption && items[index].productOption.length > 0) {
                            html1 += "<span class='regular - price'>" + items[index].productOption[0].price + "VND</span>";
                        }
                        html1 += "</div>";
                        html1 += "</div>";
                        html1 += "<div class='item_add_cart'>";
                        html1 += "<a class='grid_compare' href='compare.html1' title='Compare'><i class='icofont-random'></i></a>";
                        html1 += "<a class='grid_cart' href='cart.html1' title='Add to Cart'>Add To Cart</a>";
                        html1 += "<a class='grid_wishlist' href='wishlist.html1' title='Wishlist'><i class='icofont-heart-alt'></i></a>";
                        html1 += "</div>";
                        html1 += "</div>";
                        html1 += "<!-- Product Content End -->";
                        html1 += "</div>";
                    }
                    console.log("pageSize:" + response.pageSize);
                    $('#data-grid-view').html(html);
                    $('#list-view').html(html1);
                    pageIndex = response.currentPage;
                    Pagination(response.currentPage, response.numberPage, response.pageSize);
                } else {
                    console.error("Unexpected response structure:", response);
                }
            },
            error: function (xhr, status, error) {
                console.error("Error:", xhr.responseText);
            }

        });
        window.scrollTo(0, 0);
    }

    function Pagination(currentPage, numberPage, pageSize) {
        if (numberPage > 0) {
            var str = '<nav aria-label="Page navigation example"> <ul class="pagination">';
            if (currentPage > 1) {
                str += `<li class="page-item"><a class="page-link" onclick="NextPage(${currentPage - 1},${pageSize})" href="javascript:void(0);">Trang trước</a></li>`;
            }
            var startPage = Math.max(1, currentPage - 2);
            var endPage = Math.min(numberPage, currentPage + 2);
            if (startPage > 1) {
                str += ` <li class="page-item"><a class="page-link" onclick="NextPage(${1},${pageSize})" href="javascript:void(0);">1</a></li>`;
                if (startPage > 2) {
                    str += ` <li class="page-item"><a class="page-link" href="javascript:void(0);">...</a></li>`;
                }
            }
            for (let i = startPage; i <= endPage; i++) {
                if (currentPage === i) {
                    str += ` <li class="page-item active"><a class="page-link" href="javascript:void(0);">${i}</a></li>`;
                }
                else {
                    str += ` <li class="page-item"><a class="page-link" onclick="NextPage(${i},${pageSize})" href="javascript:void(0);">${i}</a></li>`;
                }
            }
            if (numberPage >= endPage + 1) {
                if (numberPage >= endPage + 2) {
                    str += ` <li class="page-item"><a class="page-link" href="javascript:void(0);">...</a></li>`;
                }
                str += ` <li class="page-item"><a class="page-link" onclick="NextPage(${numberPage},${pageSize})" href="javascript:void(0);">${numberPage}</a></li>`;
            }
            if (currentPage != numberPage)
                str += ` <li class="page-item"><a class="page-link" onclick="NextPage(${currentPage + 1},${pageSize})" href="javascript:void(0);">Trang sau</a></li>`;
            str += "</ul></nav>";
            $('#pagination').html(str);
        }
    }


    function NextPage(page, pageSize) {
        console.log("Nextpage:");
        console.log("PriceM: " + priceInput[0].value);
        console.log("PriceMax: " + priceInput[1].value);

        LoadData(pageSize, page, selectedBrands, selectedSort, priceInput[0].value, priceInput[1].value, selectedColors, selectedSizes);
    }
    function ChangePageSize() {
        console.log("changePageSize:");
        console.log("PriceM: " + priceInput[0].value);
        console.log("PriceMax: " + priceInput[1].value);
        pageSize = parseInt(document.getElementById("pageSizeSelect").value);
        console.log(pageSize);
        LoadData(pageSize, 1, selectedBrands, selectedSort, priceInput[0].value, priceInput[1].value, selectedColors, selectedSizes);
    }
</script>


